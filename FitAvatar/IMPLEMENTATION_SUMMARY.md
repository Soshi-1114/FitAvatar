# FitAvatar - 実装完了機能

## ✅ 実装完了した機能

### 1. 設定画面で設定した名前がホーム画面に反映される
- `AppData.swift`を作成し、アプリ全体でデータを共有できるようにしました
- `userName`プロパティを`UserDefaults`に保存し、永続化します
- `HomeView`と`SettingsView`の両方で`@ObservedObject`を使用して`AppData.shared`を参照
- 設定画面で名前を変更すると、即座にホーム画面に反映されます

### 2. トレーニング記録が統計画面とホーム画面に反映される
- `WorkoutRecord`モデルを拡張し、`Codable`プロトコルに準拠
- トレーニング完了時に`AppData.addWorkout()`を呼び出してデータを保存
- `UserDefaults`を使用してトレーニング履歴を永続化
- ホーム画面には「今日のトレーニング」が表示されます
- 統計画面にはすべてのトレーニング履歴と統計情報が表示されます
- レベルとXPが自動的に計算され、表示されます

### 3. トレーニングタイプに応じた入力フィールド
各トレーニングに`TrainingType`を追加しました：

#### 重量トレーニング（weighted）
- **例**: ダンベルベンチプレス、デッドリフト
- **入力項目**: 重量（kg）× 回数
- **インターバルタイマー**: あり

#### 自重トレーニング（bodyweight）
- **例**: プッシュアップ、懸垂、スクワット、ランジ、クランチ
- **入力項目**: 回数のみ
- **インターバルタイマー**: あり

#### 時間制トレーニング（timed）
- **例**: プランク
- **入力項目**: 秒数のみ
- **インターバルタイマー**: あり

#### 有酸素運動（cardio）
- **例**: ランニング、サイクリング
- **入力項目**: 距離（km）× 時間（分）
- **インターバルタイマー**: なし

### 4. 外観モード（ダークモード/ライトモード）の反映
- `AppData`で`appearanceMode`を管理
- 設定変更時に`applyAppearanceMode()`が自動的に呼び出されます
- システム設定、ライトモード、ダークモードの3つから選択可能
- 設定は`UserDefaults`に保存され、アプリ起動時に自動的に適用されます

## 📁 新規作成・変更ファイル

### 新規作成
- `AppData.swift` - アプリ全体のデータストア

### 変更したファイル
- `Exercise.swift` - `TrainingType`を追加
- `HomeView.swift` - `AppData`を使用して名前とトレーニング履歴を表示
- `StatisticsView.swift` - `AppData`を使用して統計情報を表示
- `SettingsView.swift` - `AppData`を使用して設定を管理
- `WorkoutRecordView.swift` - トレーニングタイプに応じた入力フィールドとデータ保存
- `MainTabView.swift` - `AppData`を初期化

## 🎯 主要な機能

### データの永続化
- `UserDefaults`を使用して以下のデータを保存：
  - ユーザー名
  - トレーニング履歴
  - 外観モード
  - 通知設定
  - 目標設定
  - アプリ設定

### XPとレベルシステム
- トレーニング完了時にXPを獲得
- XP計算式: `基本XP(15) × セット数 × 難易度倍率`
- 200 XPごとにレベルアップ
- 現在のレベルと次のレベルまでのXPを表示

### 統計情報
- 週/月/年ごとのフィルタリング
- 総トレーニング回数
- 総セット数
- 総時間
- 獲得XP
- カテゴリ別統計
- 週間トレーニング頻度グラフ

### ハプティックフィードバック
- セット完了時の振動
- タイマー終了時の振動
- ワークアウト完了時の振動
- 設定でオン/オフ可能

## 🔄 データフロー

```
設定画面で名前を変更
  ↓
AppData.userName が更新
  ↓
UserDefaults に保存
  ↓
ホーム画面が自動的に更新（@ObservedObject）

トレーニングを記録
  ↓
WorkoutRecordView で入力
  ↓
AppData.addWorkout() で保存
  ↓
UserDefaults に永続化
  ↓
統計画面とホーム画面が自動的に更新
```

## 🚀 今後の拡張可能性

- Core Dataへの移行（大量のデータに対応）
- CloudKitを使った複数デバイス間のデータ同期
- HealthKitとの連携
- チャート表示の強化
- トレーニングプランの作成機能
- ソーシャル機能（友達との共有など）
